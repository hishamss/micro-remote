"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require('../../external/@babel/runtime/helpers/toConsumableArray.js'),t=require('tslib'),n=require('react'),a=require('../../constant.js'),i=require('./types.js'),o=require('styled-components'),r=require('./styles/index.js'),l=require('@react-aria/button'),u=require('@react-aria/link'),c=require('classnames'),s=require('./NavigationContext/NavigationReducer.js'),d=require('./VerticalNavigationContext/VerticalNavigationContext.js'),f=require('../Toolkit/ToolkitNavigationContext/ToolkitNavigationContext.js'),v=require('./NavigationContext/NavigationContext.js'),p=require('../Header/HeaderContext/HeaderContext.js'),m=require('../../utility/getNativeProps/getNativeProps.js'),g=require('../../external/@uitk/react-icons/esm/CaretUpCentered.js'),N=require('../../external/@uitk/react-icons/esm/CaretDownCentered.js'),k=require('../../external/@uitk/react-icons/esm/CaretRight.js'),h=require('../../hook/useBreakpoint/index.js'),b=require('../TrackingProvider/TrackingProvider.component.js');function y(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var C=y(n),E=y(o),x=y(c),I=n.memo((function(t){var o=t.className,r=t.config,l=t.internalCallbacks,u=t.isDesktop;t.open;var c=t.useLocation,p=t.variant,m=t.ariaLabel,g=c(),N=n.useMemo((function(){return s.getActiveStateForRoute(r,{route:g,isDesktop:u})}),[r]),k=h.useBreakpoint().breakpoint;u="large"===k;var y=d.useNavigationExpanded(),E=d.useVerticalNavigationDefinedCallback(),I=b.useTracking();n.useEffect((function(){I.mount(a.TrackingConstants.components.Navigation.id)}),[I]),n.useEffect((function(){E(p===i.NavType.VERTICAL)}),[]);var _=n.useRef(null),w=n.useMemo((function(){return{openPanelButtonRef:_}}),[]),T=f.useNavTypes(),P=T.navTypes,L=T.setNavTypes;return n.useEffect((function(){P.includes(p)||L((function(t){return[].concat(e.default(t),[p])}))}),[]),C.default.createElement(v.NavigationProvider,{initialState:N,useLocation:c,variant:p,internalCallbacks:l,refs:w,config:r},C.default.createElement(j,{isDesktop:u,ariaLabel:m,open:y,isGlobalWithSecondary:(null==P?void 0:P.length)>1&&p===i.NavType.GLOBAL,className:x.default("uitk-navigation",o)}))}));I.displayName="Navigation";var _=E.default.label.withConfig({displayName:"Navigationcomponent__MenuLabel",componentId:"ih4u3c-0"})(["",""],(function(e){var t=e.theme,n=t.spacing,a=t.font,i=t.color;return o.css(["display:block;padding:"," 0;font-size:",";font-weight:",";font-family:",";color:",";"],n.m.value,a.size.heading.h4.value,a.weight.heading.h4.value,a.family.base.value,i.text.primary.value)})),w=function(e){var t=e.className,o=e.isDesktop,r=e.ariaLabel,l=n.useRef(null),u=v.useNavigationRefs().openPanelButtonRef,c=v.useNavigationState(),d=v.useNavigationVariant(),f="".concat(d.toLowerCase()," navigation"),m=v.useNavigationDispatch().closeNav,g=p.useHeaderExpandCallback(),N=function(e){var t;!function(e,t){return e.key===a.Key.ESC&&t}(e,o)?function(e,t){var n;return e.key===a.Key.TAB&&!(null===(n=t.current)||void 0===n?void 0:n.contains(e.target))}(e,l)&&function(e,t,n,a){e&&t!==i.NavType.VERTICAL?n():a(!1)}(o,d,m,g):(null===(t=u.current)||void 0===t||t.focus(),m())},k=function(e){!function(e,t,n,a){var o;return t&&n!==i.NavType.VERTICAL&&!(null===(o=a.current)||void 0===o?void 0:o.contains(e.target))}(e,o,d,l)?function(e,t,n){var a;return!t&&!(null===(a=n.current)||void 0===a?void 0:a.contains(e.target))}(e,o,l)&&g(!1):m()},h=function(e){return e.expanded?u:null};return n.useEffect((function(){return document.addEventListener("click",k),function(){return document.removeEventListener("click",k)}}),[m,o]),n.useEffect((function(){return document.addEventListener("keyup",N),function(){return document.removeEventListener("keyup",N)}}),[m,o]),C.default.createElement(O,{ref:l,variant:d,isDesktop:o,"aria-label":r||f,className:t},function(e,t){return!e&&C.default.createElement(_,null,t.label||"Menu")}(o,c),C.default.createElement(z,{isDesktop:o,level:0,variant:d},c&&c.links.map((function(e,t){return s.isPanel(e)?C.default.createElement(B,Object.assign({buttonRef:h(e),key:t,level:0,parentIconOffset:0},e)):C.default.createElement(K,Object.assign({key:t,level:0,parentIconOffset:0},e))}))))},T=function(e){var t=e.className,n=e.isDesktop,a=e.ariaLabel;return v.useNavigationVariant()===i.NavType.VERTICAL?C.default.createElement(q,null,C.default.createElement(w,{isDesktop:n,className:t,ariaLabel:a})):C.default.createElement(C.default.Fragment,null,C.default.createElement(w,{isDesktop:n,className:t,ariaLabel:a}))},P=o.css(["",""],(function(e){var t=e.theme,n=t.spacing,a=t.color;return"\n    flex-direction: column;\n    background:  ".concat(a.background.navigation.responsive.value,"; \n    padding: 0 ").concat(n.m.value," ").concat(n.xl.value," ").concat(n.m.value,";\n  ")})),L=o.css(["",""],(function(e){var t=e.theme,n=t.elevation,a=t.border,i=t.color;return"\n    box-shadow: ".concat(n.higher.horizontal.bottom.value,";\n    border-bottom: solid ").concat(a.width.large.value," ").concat(i.border.brand.base.value,";\n  ")})),j=E.default(T).withConfig({displayName:"Navigationcomponent__NavigationContainer",componentId:"ih4u3c-1"})(["",""],(function(e){var t=e.isDesktop,n=e.isGlobalWithSecondary,a=e.open;return o.css(["display:",";",";",";"],a||t?"flex":"none",!t&&a&&P,!t&&a&&!n&&L)})),R=o.css(["",""],(function(e){var t=e.theme.color;return o.css(["background:",";color:",";width:100%;"],t.background.navigation.responsive.value,t.text.navigation.global.value)})),O=E.default.nav.withConfig({displayName:"Navigationcomponent__Nav",componentId:"ih4u3c-2"})(["",";"],(function(e){var t=e.isDesktop,n=e.variant;return o.css(["button{font-family:inherit;font-size:inherit;letter-spacing:inherit;background:none;border:none;outline:none;cursor:pointer;}a{text-decoration:none;}svg{fill:currentColor;}"," ",""],!t&&R,r.getStylesForVariant(n).navStyles)})),q=E.default.aside.withConfig({displayName:"Navigationcomponent__VerticalAside",componentId:"ih4u3c-3"})([""]),D=E.default.span.withConfig({displayName:"Navigationcomponent__PanelText",componentId:"ih4u3c-4"})(["flex-grow:1;"]),V=E.default.span.withConfig({displayName:"Navigationcomponent__CaretWrapper",componentId:"ih4u3c-5"})(["",""],(function(e){var t=e.variant;return o.css(["display:inline-flex;&& svg{fill:currentColor;}",""],r.getStylesForVariant(t).caretStyles)})),A=function(e){var t,n=e.expanded,a=e.isDesktop,o=e.level,r=e.variant,l=v.useNavigationConfig(),u=l.panelClosedIcon,c=l.panelExpandedIcon,s=l.panelFlyoutIcon;return t=a&&0!==o&&r!==i.NavType.VERTICAL?s||C.default.createElement(k.default,{size:"m"}):n?c||C.default.createElement(g.default,{size:"m"}):u||C.default.createElement(N.default,{size:"m"}),C.default.createElement(V,{variant:r,level:o},t)},S=E.default.span.withConfig({displayName:"Navigationcomponent__PanelItemTriggerContent",componentId:"ih4u3c-6"})(["",""],(function(e){var t=e.theme.font;return o.css(["flex-direction:column;overflow-wrap:break-word;&:after{display:block;content:attr(data-text);font-weight:",";height:0;overflow:hidden;visibility:hidden;}"],t.weight.strong.value)})),B=function e(t){var n=t.active,a=t.buttonRef,i=t.expanded,o=t.icon,r=t.label,l=t.level,u=t.links,c=t.customContent,d=t.parentIconOffset,f=v.useNavigationVariant(),p=v.useNavigationDispatch(),m=p.closePanel,g=p.openPanel,N="large"===h.useBreakpoint().breakpoint,k=i?function(){return m(r)}:function(){return g(r,f,N)},b=o?d+1:d;return C.default.createElement(Z,{key:r,isDesktop:N,level:l,expanded:i,active:n,variant:f,parentIconOffset:d},C.default.createElement(H,{"aria-expanded":!!i,onPress:k,buttonRef:a,"data-testid":"nav-button"},C.default.createElement(D,null,!c&&o&&C.default.createElement(U,null,o),c&&C.default.createElement(U,null,c),C.default.createElement(S,{"data-text":r},r," ")),C.default.createElement(A,{variant:f,level:l,expanded:i,isDesktop:N})),i&&C.default.createElement(z,{level:l+1,isDesktop:N,variant:f},u.map((function(t){return s.isPanel(t)?C.default.createElement(e,Object.assign({parentIconOffset:b,key:t.label,level:l+1},t)):C.default.createElement(K,Object.assign({parentIconOffset:b,key:t.label,level:l+1},t))}))))},z=E.default.ul.withConfig({displayName:"Navigationcomponent__Panel",componentId:"ih4u3c-7"})(["",""],(function(e){var t=e.variant;return o.css(["margin:0;padding:0;list-style:none;display:flex;flex-direction:column;flex-grow:1;z-index:10000;",""],r.getStylesForVariant(t).panelStyles)})),F=function(e){var a=e.buttonRef,i=e.children,o=e.className,r=t.__rest(e,["buttonRef","children","className"]),u=n.useRef(),c=a||u,s=l.useButton(r,c).buttonProps;return C.default.createElement("button",Object.assign({},s,{ref:c,className:o}),i)},H=E.default(F).withConfig({displayName:"Navigationcomponent__PanelButton",componentId:"ih4u3c-8"})(["display:inline-block;"]),M=function(e){var t=e.children,a=e.url,i=n.useRef(),o=u.useLink(m.getNativeProps(e,m.anchorProperties),i).linkProps;return C.default.createElement("a",Object.assign({},o,{ref:i,href:a}),t)},G=function(e){var t=n.useRef(),a=e.children,i=l.useButton(m.getNativeProps(e,m.buttonProperties),t).buttonProps;return C.default.createElement("button",Object.assign({},i,{ref:t}),a)},W=E.default.span.withConfig({displayName:"Navigationcomponent__PanelItemActionContent",componentId:"ih4u3c-9"})(["",""],(function(e){var t=e.theme.font;return o.css(["overflow-wrap:break-word;flex-direction:column;&:after{display:block;content:attr(data-text);font-weight:",";height:0;overflow:hidden;visibility:hidden;}"],t.weight.strong.value)})),K=function(e){var n=v.useNavigationVariant(),a=v.useNavigationDispatch(),o=v.useNavigationRefs().openPanelButtonRef,r=v.useInternalCallbacks().onActionItemClick,l="large"===h.useBreakpoint().breakpoint,u=v.useNavigationOptions(),c=u.linkAs,s=u.onLinkClick,d=c||(e.onClick?G:M),f=e.level,p=e.parentIconOffset,m=t.__rest(e,["level","parentIconOffset"]),g=m.active,N=m.icon,k=m.label,b=m.customContent,y=m.onClick?m.onClick:s,E=m.active?{"aria-current":!0}:{};return C.default.createElement(J,{key:k,isDesktop:l,level:f,active:g,variant:n,parentIconOffset:p},C.default.createElement(d,Object.assign({},m,E,{onClick:function(e){r&&r(l),l&&(function(e,t){e!==i.NavType.GLOBAL&&e!==i.NavType.HORIZONTAL||t.closeNav()}(n,a),function(e,t,n){0!==t&&e!==i.NavType.VERTICAL&&(null==n?void 0:n.current)&&n.current.focus()}(n,f,o)),y&&y(e,m)},"data-testid":"nav-link"}),C.default.createElement("span",null,!b&&N&&C.default.createElement(U,null,N),b&&C.default.createElement(U,null,b),C.default.createElement(W,{"data-text":k},k))))},U=E.default.span.withConfig({displayName:"Navigationcomponent__IconWrapper",componentId:"ih4u3c-10"})(["display:inline-flex;align-items:center;margin-right:",";"],(function(e){return e.theme.spacing.xs.value})),Z=E.default.li.withConfig({displayName:"Navigationcomponent__PanelItemTrigger",componentId:"ih4u3c-11"})(["",""],(function(e){var t=e.variant;return o.css(["",""],r.getStylesForVariant(t).panelItemTriggerStyles)})),J=E.default.li.withConfig({displayName:"Navigationcomponent__PanelItemAction",componentId:"ih4u3c-12"})(["",""],(function(e){var t=e.variant;return o.css(["",""],r.getStylesForVariant(t).panelItemActionStyles)}));exports.Navigation=I,exports.NavigationContainer=j;
