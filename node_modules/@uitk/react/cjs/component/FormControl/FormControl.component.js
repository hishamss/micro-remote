"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require('../../external/@babel/runtime/helpers/toConsumableArray.js'),r=require('tslib'),t=require('react'),a=require('styled-components'),n=require('../../constant.js'),o=require('classnames'),l=require('@react-aria/visually-hidden'),i=require('../Error/Error.component.js'),s=require('../TrackingProvider/TrackingProvider.component.js');function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var d=c(t),u=c(a),m=c(o),p=function(e,r){return e.some((function(e){return e.type.uitkName===r}))},f=function(e,r,t,a,n,o,l){var i=function(e,r,t,a,n){var o=[],l=p(t,"Label"),i=p(t,"HelperText"),s=p(t,"Checkbox");return(!a&&s||n&&l)&&o.push("".concat(r,"-lbl")),!a&&i&&o.push("".concat(r,"-ht")),e&&o.push("".concat(r,"-err")),o.length?o.join(" "):null}(t,a,r,e,l);return{Label:Object.assign({disabled:o,error:!!t,htmlFor:p(r,"Checkbox")||p(r,"RadioButton")?null:a,id:"".concat(a,"-lbl"),required:n},e&&{forLegend:!0}),HelperText:{disabled:o,id:"".concat(a,"-ht")},FormField:Object.assign(Object.assign({disabled:o},!e&&{error:!!t,required:n}),{"aria-describedby":i,id:a}),Error:{id:"".concat(a,"-err")}}},g=a.css(["",""],(function(e){var r=e.theme,t=r.border,n=r.boxshadow,o=r.color;return a.css(["background-color:",";box-shadow:",";border-radius:",";"],o.semantic.error.subtle.value,n.form.error.value,t.radius.form.element.value)})),v=u.default.fieldset.withConfig({displayName:"FormControlcomponent__FormControlFieldset",componentId:"sc-2v5aj0-0"})(["",""],(function(e){var r=e.theme,t=r.border,n=r.color,o=r.spacing;return a.css(["padding:0 "," "," ",";border-radius:",";border:"," solid ",";"],o.base.value,o.base.value,o.xs.value,t.radius.form.element.value,t.width.form.element.base.value,n.border.accessible.value)})),b=u.default.legend.withConfig({displayName:"FormControlcomponent__FormControlLegend",componentId:"sc-2v5aj0-1"})(["",""],(function(e){var r=e.theme.spacing;return a.css(["padding:0 ",";"],r.xs.value)})),y=u.default(i.Error).withConfig({displayName:"FormControlcomponent__GroupError",componentId:"sc-2v5aj0-2"})(["",""],(function(e){var r=e.theme.spacing;return a.css(["margin-left:",";"],r.xs.value)})),h=function(e){var t=e.children,a=e.className;e.error;var n=r.__rest(e,["children","className","error"]);return d.default.createElement("ul",Object.assign({className:a},n),t)},F=u.default(h).withConfig({displayName:"FormControlcomponent__GroupList",componentId:"sc-2v5aj0-3"})(["",""],(function(e){var r=e.error,t=e.theme.spacing;return a.css(["list-style-type:none;padding:0;margin:"," 0 0 ",";",""],t.xxs.value,t.xs.value,r&&g)})),j=function(e){var t=e.children,a=e.className,n=r.__rest(e,["children","className"]);return d.default.createElement("li",Object.assign({},n,{className:a}),t)},N=u.default(j).withConfig({displayName:"FormControlcomponent__GroupListItem",componentId:"sc-2v5aj0-4"})(["list-style:none;"]),E=function(e){var r=e.children,t=e.className,a=e.error,n=e.id,o=e.required,i=l.useVisuallyHidden().visuallyHiddenProps;return d.default.createElement(v,{className:m.default("uitk-form-control",t),"data-testid":"grouped-fieldset"},d.default.createElement(b,{"data-testid":"grouped-legend"},r.Label,o&&d.default.createElement("span",Object.assign({},i),"Required"),r.HelperText,"string"==typeof a&&d.default.createElement("span",Object.assign({"aria-live":"assertive"},i),a)),"string"==typeof a&&d.default.createElement(y,{ariaHidden:!0,"data-testid":"grouped-error",id:"".concat(n,"-err")},a),d.default.createElement(F,{"data-testid":"grouped-list",error:a},r.FormField.map((function(e,r){return d.default.createElement(N,{key:"".concat(n,"-").concat(r)},e)}))))},k=function(e){var r=e.children,t=e.className,a=e.error,n=e.id;return d.default.createElement("div",{className:m.default("uitk-form-control",t)},r.Label,r.HelperText,"string"==typeof a&&d.default.createElement(i.Error,{id:"".concat(n,"-err")},a),r.FormField)},C=function(r){var a,o,l,i,c,u=r.children,m=r.className,p=r.disabled,g=r.error,v=r.id,b=r.required,y=s.useTracking();t.useEffect((function(){y.mount(n.TrackingConstants.components.FormControl.id)}),[y]);var h=Array.isArray(u)?u:[u],F=(a=[]).concat.apply(a,e.default(h));if(u){var j=F.filter((function(e){return(null==e?void 0:e.type)&&"FormField"===e.type.uitkType}));i=j.length>1,c="Dropdown"===(null===(o=j[0])||void 0===o?void 0:o.type.uitkName);var N=F.filter((function(e){return(null==e?void 0:e.type)&&"FormField"!==e.type.uitkType})),C=f(i,[].concat(e.default(j),e.default(N)),g,v,b,p,c),x=j.map((function(e,r){var t=Object.assign({},C.FormField);i&&(t.id="".concat(t.id,"-").concat(r+1));var a=e.props.originalClassName;return d.default.cloneElement(e,Object.assign(Object.assign(Object.assign(Object.assign({},e.props),t),{key:t.id}),i&&!!g&&{className:"".concat(null!=a?a:""," grouped-form-field--error")}))})),_=N.map((function(e){return d.default.cloneElement(e,Object.assign(Object.assign(Object.assign({},e.props),C[e.type.uitkName]),{key:e.props.id}))}));l=[].concat(e.default(x),e.default(_)).reduce((function(e,r){return"FormField"===r.type.uitkType?e[r.type.uitkType].push(r):e[r.type.uitkName]=r,e}),{FormField:[]})}return d.default.createElement(d.default.Fragment,null,i?d.default.createElement(E,{id:v,className:m,error:g,required:b},l):d.default.createElement(k,{id:v,className:m,error:g},l))};exports.FormControl=C,exports.default=C;
