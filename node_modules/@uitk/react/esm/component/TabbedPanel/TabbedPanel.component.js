import e from'../../external/@babel/runtime/helpers/slicedToArray.js';import n,{useEffect as a,useState as t,useRef as o,createRef as r}from'react';import{TrackingConstants as i,Breakpoint as l,Key as c}from'../../constant.js';import d,{css as u,keyframes as s}from'styled-components';import b from'classnames';import{useButton as m}from'@react-aria/button';import{TransitionGroup as p,Transition as f}from'react-transition-group';import{lighten as v}from'polished';import{Panel as g}from'../Panel/Panel.component.js';import{useTracking as h}from'../TrackingProvider/TrackingProvider.component.js';import{useControllableState as x}from'../../hook/useControllableState/useControllableState.js';import{getUuid as y}from'../../utility/getUuid/getUuid.js';var P={enter:"0",entering:"0",entered:"1",exiting:"0",exited:"0"},k=d.div.withConfig({displayName:"TabbedPanelcomponent__Container",componentId:"sc-1gf0ofu-0"})(["width:100%;.uitk-accordion{display:block;}@media ","{.uitk-accordion{display:none;}}"],l.s),w=function(o){var r=o.className,l=o.id,c=o.onHeaderPress,d=o.panels,u=o.selectedPanel,s=o.titlesAs,m=h();a((function(){m.mount(i.components.TabbedPanel.id)}),[m]);var v=x(u,c,0),P=e(v,2),w=P[0],T=P[1],I=t((function(){return l||y("tabbed-panel-container")})),_=e(I,1)[0],N=t((function(){return y("tabbed-panel")})),C=e(N,1)[0],H=function(e){return"".concat(C,"-").concat(e)},L=function(e){return"".concat(C,"-tab").concat(e)},D=function(e){null!==e&&T(e)};return n.createElement(k,{className:b("uitk-tabbed-panel",r)},n.createElement(E,{id:_},n.createElement(j,{panels:d,onHeaderPress:D,selectedPanel:w,id:C,getPanelIdForIndex:H,getTabIdForIndex:L}),n.createElement(p,null,n.createElement(f,{timeout:0,key:w,exit:!1},(function(e){return n.createElement(A,{role:"tabpanel","aria-labelledby":L(w),tabIndex:0,"data-testid":"tabbed-content",transition:e,id:H(w)},d[w].content)})))),n.createElement(g.AccordionGroup,{onHeaderPress:D,open:w},d.map((function(e){return n.createElement(g,{titleAs:s,title:e.header,key:"accordion-panel-".concat(e.header)},e.content)}))))},E=d.div.withConfig({displayName:"TabbedPanelcomponent__StyledTabbedPanel",componentId:"sc-1gf0ofu-1"})(["",""],(function(e){var n=e.theme,a=n.border,t=n.color;return u(["display:none;background-color:",";border:"," solid ",";border-radius:",";flex-direction:column;width:100%;@media ","{display:flex;}"],t.background.surface.base.value,a.width.panels.value,t.border.base.value,a.radius.base.value,l.s)})),T=s(["from{opacity:0;width:0;}to{opacity:1;width:100%;}"]),I=u(["",""],(function(e){var n=e.theme,a=n.font,t=n.color,o=n.animation,r=n.spacing;return u(["font-weight:",";color:",';:after{content:" ";position:absolute;top:0;right:0;bottom:0;left:0;box-shadow:0 4px 0 0 ',";animation:"," "," linear;margin-right:",";}"],a.weight.medium.value,t.text.base.value,t.border.brand.base.value,T,o.duration.animate.medium.value,r.xs.value)})),_=n.forwardRef((function(e,a){var t=e.ariaControls,o=e.ariaLabelledBy,r=e.ariaSelected,i=e.buttonTabIndex,l=e.children,c=e.className,d=e.id,u=e.onPress,s=m({onPress:u},a).buttonProps;return n.createElement("button",Object.assign({className:b("uitk-tabbed-panel-button",c),id:d,"aria-selected":r,role:"tab","aria-labelledby":o,ref:a},s,{"aria-controls":t,tabIndex:i}),l)}));_.displayName="_TabbedPanelHeaderButton";var N=u(["",""],(function(e){var n=e.theme,a=n.border,t=n.color;return"\n    border-radius: ".concat(a.radius.base.value,";\n    box-shadow: 0 0 0 3px ").concat(t.border.brand.base.value,";\n    color: ").concat(t.text.base.value,";\n    outline: none;\n  ")})),C=d(_).withConfig({displayName:"TabbedPanelcomponent__TabbedPanelHeaderButton",componentId:"sc-1gf0ofu-2"})(["",""],(function(e){var n=e.active,a=e.theme,t=a.border,o=a.color,r=a.spacing;return u(["background:none;border:none;font:inherit;cursor:pointer;outline:inherit;display:flex;color:",";margin:0 "," "," 0;padding:"," ",";text-decoration:none;&:active{color:",";}&:hover,&:focus{border-radius:",";color:",";box-shadow:0 0 0 3px ",";outline:none;}&:focus{",";}",""],v(.095,o.text.base.value),r.xs.value,r.xs.value,r.sm.value,r.xs.value,o.text.base.value,t.radius.base.value,o.text.base.value,o.border.brand.base.value,N,n&&I)})),H=d.span.withConfig({displayName:"TabbedPanelcomponent__TabbedPanelList",componentId:"sc-1gf0ofu-3"})(["",""],(function(e){var n=e.theme,a=n.color,t=n.spacing;return u(["border-bottom:4px solid ",";display:flex;flex-wrap:wrap;list-style:none;margin:"," "," 0 ",";padding:0;position:relative;"],a.background.accent.subtle.value,t.sm.value,t.m.value,t.base.value)})),L=d.span.withConfig({displayName:"TabbedPanelcomponent__TabbedPanelListItem",componentId:"sc-1gf0ofu-4"})(["",""],(function(e){var n=e.theme,a=n.color,t=n.spacing;return u(["box-shadow:0 4px 0 0 ",";outline:none;position:relative;white-space:nowrap;margin-top:",";"],a.background.accent.subtle.value,t.sm.value)})),j=function(i){var l=i.className,d=i.getPanelIdForIndex,u=i.getTabIdForIndex,s=i.onHeaderPress,m=i.panels,p=i.selectedPanel,f=o(),v=t([]),g=e(v,2),h=g[0],x=g[1],y=function(o,r){var i=t(null),l=e(i,2),d=l[0],u=l[1],s=n.useCallback((function(e){var n=r.length,a=null!==d?d:0;switch(e.key){case c.RIGHT_ARROW:case c.RIGHT:e.preventDefault(),u(a===n-1?0:a+1);break;case c.LEFT_ARROW:case c.LEFT:e.preventDefault(),u(0===a?n-1:a-1);break;case c.HOME:e.preventDefault(),u(0);break;case c.END:e.preventDefault(),u(n-1)}}),[d,r]);return a((function(){if(o.current){var e=function(e){o.current.contains(e.target)&&(e.key!==c.HOME&&e.key!==c.END||e.preventDefault())};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}}),[o]),a((function(){if(null!==d){var e=r[d].current;document.activeElement!==e&&(null==e||e.focus())}}),[r,d]),a((function(){var e=o.current;if(e)return o.current.addEventListener("keyup",s,!1),function(){e.removeEventListener("keyup",s,!1)}}),[o,s]),[d,u]}(f,h),P=e(y,2)[1];return a((function(){for(var e=new Array(m.length),n=0;n<e.length;n++)e[n]=r();x(e)}),[m]),n.createElement("div",{className:b("uitk-tabbed-panel-header",l)},n.createElement(H,{role:"tablist","aria-label":"tabs",ref:f},m.map((function(e,a){return n.createElement(L,{key:"tabbed-panel-btn-".concat(e.header)},n.createElement(C,{ref:h[a],id:u(a),"data-testid":"tabbed-panel-header-btn",onPress:function(){s(a),P(a)},active:p===a,buttonTabIndex:0===a?0:-1,ariaSelected:p===a,ariaControls:p===a?d(a):null},e.header))}))))},A=d.div.withConfig({displayName:"TabbedPanelcomponent__TabbedContent",componentId:"sc-1gf0ofu-5"})(["",""],(function(e){var n=e.transition,a=e.theme,t=a.spacing,o=a.animation,r=a.border,i=a.color;return u(["margin-top:",";padding:"," "," "," ",";transition:opacity "," linear;opacity:",";&:focus{border-radius:",";box-shadow:0 0 0 3px ",";border-color:",";outline:none;}"],t.sm.value,t.m.value,t.base.value,t.xxl.value,t.base.value,o.duration.animate.slow.value,P[n],r.radius.base.value,i.border.brand.base.value,i.text.brand.value)}));export{w as TabbedPanel};
