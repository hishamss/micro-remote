import e from'../../external/@babel/runtime/helpers/toConsumableArray.js';import{__rest as r}from'tslib';import t,{useEffect as n}from'react';import o,{css as a}from'styled-components';import{TrackingConstants as i}from'../../constant.js';import l from'classnames';import{useVisuallyHidden as s}from'@react-aria/visually-hidden';import{Error as c}from'../Error/Error.component.js';import{useTracking as d}from'../TrackingProvider/TrackingProvider.component.js';var m=function(e,r){return e.some((function(e){return e.type.uitkName===r}))},u=function(e,r,t,n,o,a,i){var l=function(e,r,t,n,o){var a=[],i=m(t,"Label"),l=m(t,"HelperText"),s=m(t,"Checkbox");return(!n&&s||o&&i)&&a.push("".concat(r,"-lbl")),!n&&l&&a.push("".concat(r,"-ht")),e&&a.push("".concat(r,"-err")),a.length?a.join(" "):null}(t,n,r,e,i);return{Label:Object.assign({disabled:a,error:!!t,htmlFor:m(r,"Checkbox")||m(r,"RadioButton")?null:n,id:"".concat(n,"-lbl"),required:o},e&&{forLegend:!0}),HelperText:{disabled:a,id:"".concat(n,"-ht")},FormField:Object.assign(Object.assign({disabled:a},!e&&{error:!!t,required:o}),{"aria-describedby":l,id:n}),Error:{id:"".concat(n,"-err")}}},p=a(["",""],(function(e){var r=e.theme,t=r.border,n=r.boxshadow,o=r.color;return a(["background-color:",";box-shadow:",";border-radius:",";"],o.semantic.error.subtle.value,n.form.error.value,t.radius.form.element.value)})),f=o.fieldset.withConfig({displayName:"FormControlcomponent__FormControlFieldset",componentId:"sc-2v5aj0-0"})(["",""],(function(e){var r=e.theme,t=r.border,n=r.color,o=r.spacing;return a(["padding:0 "," "," ",";border-radius:",";border:"," solid ",";"],o.base.value,o.base.value,o.xs.value,t.radius.form.element.value,t.width.form.element.base.value,n.border.accessible.value)})),g=o.legend.withConfig({displayName:"FormControlcomponent__FormControlLegend",componentId:"sc-2v5aj0-1"})(["",""],(function(e){var r=e.theme.spacing;return a(["padding:0 ",";"],r.xs.value)})),v=o(c).withConfig({displayName:"FormControlcomponent__GroupError",componentId:"sc-2v5aj0-2"})(["",""],(function(e){var r=e.theme.spacing;return a(["margin-left:",";"],r.xs.value)})),b=o((function(e){var n=e.children,o=e.className;e.error;var a=r(e,["children","className","error"]);return t.createElement("ul",Object.assign({className:o},a),n)})).withConfig({displayName:"FormControlcomponent__GroupList",componentId:"sc-2v5aj0-3"})(["",""],(function(e){var r=e.error,t=e.theme.spacing;return a(["list-style-type:none;padding:0;margin:"," 0 0 ",";",""],t.xxs.value,t.xs.value,r&&p)})),y=o((function(e){var n=e.children,o=e.className,a=r(e,["children","className"]);return t.createElement("li",Object.assign({},a,{className:o}),n)})).withConfig({displayName:"FormControlcomponent__GroupListItem",componentId:"sc-2v5aj0-4"})(["list-style:none;"]),h=function(e){var r=e.children,n=e.className,o=e.error,a=e.id,i=e.required,c=s().visuallyHiddenProps;return t.createElement(f,{className:l("uitk-form-control",n),"data-testid":"grouped-fieldset"},t.createElement(g,{"data-testid":"grouped-legend"},r.Label,i&&t.createElement("span",Object.assign({},c),"Required"),r.HelperText,"string"==typeof o&&t.createElement("span",Object.assign({"aria-live":"assertive"},c),o)),"string"==typeof o&&t.createElement(v,{ariaHidden:!0,"data-testid":"grouped-error",id:"".concat(a,"-err")},o),t.createElement(b,{"data-testid":"grouped-list",error:o},r.FormField.map((function(e,r){return t.createElement(y,{key:"".concat(a,"-").concat(r)},e)}))))},F=function(e){var r=e.children,n=e.className,o=e.error,a=e.id;return t.createElement("div",{className:l("uitk-form-control",n)},r.Label,r.HelperText,"string"==typeof o&&t.createElement(c,{id:"".concat(a,"-err")},o),r.FormField)},j=function(r){var o,a,l,s,c,m=r.children,p=r.className,f=r.disabled,g=r.error,v=r.id,b=r.required,y=d();n((function(){y.mount(i.components.FormControl.id)}),[y]);var j=Array.isArray(m)?m:[m],N=(o=[]).concat.apply(o,e(j));if(m){var E=N.filter((function(e){return(null==e?void 0:e.type)&&"FormField"===e.type.uitkType}));s=E.length>1,c="Dropdown"===(null===(a=E[0])||void 0===a?void 0:a.type.uitkName);var k=N.filter((function(e){return(null==e?void 0:e.type)&&"FormField"!==e.type.uitkType})),C=u(s,[].concat(e(E),e(k)),g,v,b,f,c),x=E.map((function(e,r){var n=Object.assign({},C.FormField);s&&(n.id="".concat(n.id,"-").concat(r+1));var o=e.props.originalClassName;return t.cloneElement(e,Object.assign(Object.assign(Object.assign(Object.assign({},e.props),n),{key:n.id}),s&&!!g&&{className:"".concat(null!=o?o:""," grouped-form-field--error")}))})),O=k.map((function(e){return t.cloneElement(e,Object.assign(Object.assign(Object.assign({},e.props),C[e.type.uitkName]),{key:e.props.id}))}));l=[].concat(e(x),e(O)).reduce((function(e,r){return"FormField"===r.type.uitkType?e[r.type.uitkType].push(r):e[r.type.uitkName]=r,e}),{FormField:[]})}return t.createElement(t.Fragment,null,s?t.createElement(h,{id:v,className:p,error:g,required:b},l):t.createElement(F,{id:v,className:p,error:g},l))};export{j as FormControl,j as default};
